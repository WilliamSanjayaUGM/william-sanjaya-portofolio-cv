<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>William Sanjaya — Indonesia</title>

  <link rel="stylesheet" th:href="@{/css/style.css}">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&family=Inter:wght@300;400;600&display=swap" rel="stylesheet">
</head>

<body>
	<div class="aurora"></div>
	<div class="mist"></div>
	<canvas id="stars"></canvas> <!-- move this line here -->
	<div class="satellite"></div>

  <div class="intro-section">
    <div class="content">
      <div class="intro fade-in">
        <h1>William Sanjaya</h1>
        <p class="role">RDC Software Engineer @ OCBC Indonesia</p>
        <p class="slogan"><em><strong>
          Building future-ready systems where engineering precision meets AI collaboration and entrepreneurial creativity.
        </strong></em></p>
        <p class="scroll-hint">↓ Scroll to Explore ↓</p>
      </div>
    </div>
  </div>

  <script th:src="@{/js/animation.js}"></script>
  <script>
  document.addEventListener("DOMContentLoaded", () => {
    if (sessionStorage.getItem("fromAbout") === "true") {
      sessionStorage.removeItem("fromAbout");
      document.body.classList.add("reenter");
      requestAnimationFrame(() => {
        document.body.classList.add("loaded");
      });
    } else {
      document.body.classList.add("loaded");
    }

    const btn = document.getElementById("discoverBtn");
    const aurora = document.querySelector(".aurora");
    const content = document.querySelector(".content");

    if (btn) {
      btn.addEventListener("click", (e) => {
        e.preventDefault();
        triggerTransition();
      });
    }

    let scrolled = false;
    window.addEventListener("wheel", (event) => {
      if (!scrolled && event.deltaY > 80) {
        scrolled = true;
        triggerTransition();
      }
    }, { passive: true });

    let startY = 0;
    window.addEventListener("touchstart", e => startY = e.touches[0].clientY);
    window.addEventListener("touchmove", e => {
      const endY = e.touches[0].clientY;
      if (!scrolled && startY - endY > 80) {
        scrolled = true;
        triggerTransition();
      }
    });

    function triggerTransition() {
      sessionStorage.setItem("fromIndex", "true");
      content.classList.add("fade-slide-up");
      aurora.classList.add("aurora-morph");
      setTimeout(() => {
        window.location.href = "/about";
      }, 650);
    }

    window.addEventListener("pageshow", (event) => {
      if (event.persisted) {
        content.classList.remove("fade-slide-up");
        aurora.classList.remove("aurora-morph");
        requestAnimationFrame(() => {
          content.classList.add("fade-in");
        });
      }
    });

    // === PARALLAX ===
	let lastMove = 0;
	document.addEventListener("mousemove", (e) => {
	  const now = performance.now();
	  if (now - lastMove < 50) return; // limit to ~20fps
	  lastMove = now;
	  const x = (e.clientX / window.innerWidth - 0.5) * 20;
	  const y = (e.clientY / window.innerHeight - 0.5) * 20;
	  aurora.style.transform = `translate(${x * -0.4}px, ${y * -0.4}px)`;
	});
  });
  </script>

  <script>
  // === SHOOTING STARS ===
  const canvas = document.getElementById('stars');
  const ctx = canvas.getContext('2d');
  canvas.width = window.innerWidth;
  canvas.height = window.innerHeight;

  const stars = Array.from({ length: 100 }, () => ({
    x: Math.random() * canvas.width,
    y: Math.random() * canvas.height,
    r: Math.random() * 1.2,
    o: Math.random()
  }));

  let shootingStars = [];

  function spawnShootingStar() {
    const s = {
      x: Math.random() * canvas.width,
      y: Math.random() * 100,
      length: 300,
      speed: 15 + Math.random() * 10,
      opacity: 0.5 + Math.random() * 0.5
    };
    shootingStars.push(s);
    setTimeout(spawnShootingStar, 4000 + Math.random() * 4000);
  }

  function drawStars() {
    ctx.fillStyle = '#fff';
    for (const s of stars) {
      ctx.globalAlpha = s.o;
      ctx.beginPath();
      ctx.arc(s.x, s.y, s.r, 0, Math.PI * 2);
      ctx.fill();
    }
    ctx.globalAlpha = 1;
  }
  
  for (const s of stars) {
    s.o += (Math.random() - 0.5) * 0.02;
    s.o = Math.min(1, Math.max(0.3, s.o));
  }

  function drawShootingStars() {
    ctx.save();
    ctx.strokeStyle = 'rgba(255,255,255,0.8)';
    ctx.lineWidth = 2;
    for (let i = 0; i < shootingStars.length; i++) {
      const s = shootingStars[i];
      ctx.beginPath();
      ctx.moveTo(s.x, s.y);
      ctx.lineTo(s.x - s.length, s.y + s.length);
      ctx.stroke();

      s.x += s.speed;
      s.y += s.speed;
      s.opacity -= 0.01;
      if (s.opacity <= 0) shootingStars.splice(i, 1);
    }
    ctx.restore();
  }

  function animate() {
    ctx.globalAlpha = 0.9; // keep last frame trail
    ctx.fillStyle = "rgba(0, 0, 0, 0.3)";
    ctx.fillRect(0, 0, canvas.width, canvas.height);
    drawStars();
    drawShootingStars();
    requestAnimationFrame(animate);
  }

  spawnShootingStar();
  animate();
  </script>
</body>
</html>